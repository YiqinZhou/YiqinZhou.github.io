'''
@author: 
@date: 

@note: 

'''

import sys
import re

from compsci260lib import *

def solve_cloning():
    """Your code goes here..."""
    
     #a) beginning, end and length of the Cdc24 gene
    beginning=1000
    end=3564
    
    length_of_gene=end-beginning+1
    print "Length of gene is "+str(length_of_gene)
    
    length_of_peptide_product= (end-beginning+1-3)/3
    print "Length of peptide product is "+str(length_of_peptide_product)
    
    #b)
    dict=get_fasta_dict("cdc24_plus_minus_1kb.fasta")
    
    upstream=dict['cdc24'][0:1000]
    downstream=dict['cdc24'][3565:]
    
        #Reverse DNA strand starting with 3'
    reverseStrand=""
    for i in dict['cdc24']:
        if (i=="c"):
            reverseStrand=reverseStrand+"g";
        if (i=="g"):
            reverseStrand=reverseStrand+"c";
        if (i=="a"):
            reverseStrand=reverseStrand+"t";
        if (i=="t"):
            reverseStrand=reverseStrand+"a";
            
    reverseUpstream= reverseStrand[:1000]
    reverseDownstream=reverseStrand[3565:] 
    
    
    
    #BamHI, it is palindromic, so only need to check one strand
    test="ggatccatfggatcc"
    BamHI=([i.start() for i in re.finditer("ggatcc",upstream)]+
           [i.start()+3565 for i in re.finditer("ggatcc",downstream)])
    print "Location for BamHI is "+str(BamHI)
    
    

    #BstYI
    BstYI=([i.start() for i in re.finditer("[a,g]gatc[c,t]",upstream)]+
          [i.start()+3565 for i in re.finditer("[a,g]gatc[c,t]",downstream)]+
           [i.start() for i in re.finditer("[c,t]ctag[a,g]",reverseUpstream)]+
           [i.start()+3565 for i in re.finditer("[c,t]ctag[a,g]",reverseDownstream)])
    
    #sequence of BstYI
    BstYISequence=([i for i in re.findall("[a,g]gatc[c,t]",upstream)]+
          [i for i in re.findall("[a,g]gatc[c,t]",downstream)]+
           [i for i in re.findall("[c,t]ctag[a,g]",reverseUpstream)]+
           [i for i in re.findall("[c,t]ctag[a,g]",reverseDownstream)])
    
    print "Location for BstYI is "+str(BstYI)
    print "Actual sequences for BstYI are "+str(BstYISequence)
    
    #SpeI, only need to check one strand
    SpeI=([i.start() for i in re.finditer("actagt",upstream)]+
          [i.start()+3565 for i in re.finditer("actagt",downstream)])         
    print "Location for SpeI is "+str(SpeI)
    
    #SphI, only need to check one strand
    SphI=([i.start() for i in re.finditer("gcatgc",upstream)]+
          [i.start()+3565 for i in re.finditer("gcatgc",downstream)])
    print "Location for SphI is "+str(SphI)
    
    #styI, not palindromic, need to check both
    styI=([i.start() for i in re.finditer("cc[a,t][a,t]gg",upstream)]+
          [i.start()+3565 for i in re.finditer("cc[a,t][a,t]gg",downstream)]+
          [i.start() for i in re.finditer("gg[a,t][a,t]cc",reverseUpstream)]+
           [i.start()+3565 for i in re.finditer("gg[a,t][a,t]cc",reverseDownstream)])
    styISequence=([i for i in re.findall("cc[a,t][a,t]gg",upstream)]+
          [i for i in re.findall("cc[a,t][a,t]gg",downstream)]+
          [i for i in re.findall("gg[a,t][a,t]cc",reverseUpstream)]+
           [i for i in re.findall("gg[a,t][a,t]cc",reverseDownstream)])
    print "Location for StyI is "+str(styI)
    print "Actual Sequence for StyI are "+str(styISequence)
    
    
    
    
    




if __name__ == '__main__':
    solve_cloning()
    
   
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    