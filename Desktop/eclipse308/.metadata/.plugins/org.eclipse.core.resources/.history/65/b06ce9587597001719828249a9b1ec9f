'''
@author: 
@date:

@note:

'''

import sys, random
from compsci260lib import *

def find_genes(sequence, min_length):
    
    start_codon=[i.start() for i in re.finditer("aug",sequence)]
    stop_codon=[i.start() for i in re.finditer("uag",sequence)]+[i.start() for i in re.finditer("uga",sequence)]+[i.start() for i in re.finditer("uaa",sequence)]
    stop_codon.sort()
    print start_codon
    print stop_codon
    print sequence[63:66]
    list=[]
    
    for i in range(len(stop_codon)):
        this_stop_codon=stop_codon[i]
        print "this stop codon is"+str(this_stop_codon)
        if i!=0:
            for k in stop_codon[:i:-1]: 
                if k%3==stop_codon[i]%3:
                    previous_stop_codon=stop_codon[i-1]
                break
        if i==0:
            previous_stop_codon=0
        
       
            
        for j in start_codon:
        
            if j>=previous_stop_codon and j<this_stop_codon and j%3==this_stop_codon%3:
               
                if this_stop_codon-j+1>=min_length:
                    
                    dict={}
                    dict['frame']=j%3
                    dict['stop']=this_stop_codon
                    dict['aalength']=(this_stop_codon-j+1-3)/3
                    dict['start']=j 
                    dict['stopcodon']=sequence[this_stop_codon:this_stop_codon+3]
                    dict['nlength']=(this_stop_codon-j+1)
                    list.append(dict)
                    
                    
                    
                break
        
    return list   
                    
          

def solve_orfs():
    """Your code goes here..."""
    
    #a)
    dict=get_fasta_dict("sars.fasta")
    sequence=dict["sars"]
    list=find_genes(sequence,10)
    print list
    








	
if __name__ == '__main__':
    solve_orfs()
